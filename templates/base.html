<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>EXMATCH【いまここで出会う】 | {% block title %}{% endblock %}</title>
    {% load static %}

	<!-- <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script> -->

  	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Drawer CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/drawer/3.2.2/css/drawer.min.css">
    <!-- Slick CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">
    <!-- Font Awesome Kit -->
    <script src="https://kit.fontawesome.com/66f29bbc2b.js"></script>
    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/fontawesome.min.css"
      referrerpolicy="no-referrer" />
    <link rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/solid.min.css"
      referrerpolicy="no-referrer" />
    <!-- swiper -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">

    <!-- google icon -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=barefoot,chevron_right,favorite,forum,star_3,home,mail,menu,person,search,help_center,schedule,location_on,check,stat_minus_3,open_in_new" />


    {% block extra_css %}{% endblock %}
</head>
<body class="{% if unverified %}unverified{% endif %} {%block base_class%}base{% endblock %} {% if not lciq_done %}lciq-unset{% endif %}">

  {% if request.resolver_match.url_name != "home" %}
<header class="main-header container">
    <div class="main-header__wrap">
      <div class="logo">
        <a href="{% url 'my_page' %}">
          <img src="{% static 'img/logo.svg' %}" alt="">
        </a>
      </div>
      <div class="menu">
        <span class="material-symbols-outlined">menu</span>
      </div>
    </div>
</header>
{% endif %}

<main class="{% block main_container %}container{% endblock %} m-auto">
    {% block content %}
    <!-- メインコンテンツ -->
    {% endblock %}
</main>

<footer class="footer {% block footer_class %}{% endblock %}">
    <ul class="footer__wrap container">
        <li><a href="{% url 'my_page' %}"><span class="material-symbols-outlined">person</span></a></li>
        <li><a href="{% url 'userprofile_list' %}"><span class="material-symbols-outlined">search</span></a></li>
        <li><a href="{% url 'chat_index' %}"><span id="notif-badge" class="badge" style="display:none;">0</span><span class="material-symbols-outlined">mail</span></a></li>
        <!-- <li><a href="{% url 'account_logout' %}">ログアウト</a></li> -->
    </ul>
</footer>

<!-- jQuery (必要に応じて) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- bootstrap -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<!-- iScroll -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/iScroll/5.2.0/iscroll.min.js"></script>
<!-- drawer.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/drawer/3.2.2/js/drawer.min.js"></script>
<!-- Slick -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
<!-- swiper -->
<script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>


{% if request.user.is_authenticated %}
<script>
(function(){
  const badge   = document.getElementById('notif-badge');
  if(!badge) return;

  function updateBadge(){
    fetch('/api/notifications/unread/')
      .then(r => r.json())
      .then(({unread}) => {
        if(unread){
          badge.textContent = unread;
          badge.style.display = 'inline-block';
        }else{
          badge.style.display = 'none';
        }
      })
      .catch(console.error);
  }
  updateBadge();             // 初回
  setInterval(updateBadge, 30000);  // 10 秒ごと
})();
</script>
{% endif %}

<script src="{% static 'js/global.js' %}"></script>
<script src="{% static 'js/loop.js' %}"></script>
<script src="{% static 'js/custom.js' %}"></script>

{% block extra_js %}{% endblock %}
{% load django_browser_reload %}
{% django_browser_reload_script %}
</body>
</html>
